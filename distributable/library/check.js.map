{"version":3,"sources":["../../source/library/check.js"],"names":["BaseCheck","BaseTransform","Is","Merge","Ava","Babel","FileParseError","FolderParseError","Process","process","transform","Transform","Check","userPath","cwd","userOption","Promise","resolve","reject","defaultOption","parser","es7","default","special","bin","eslint","map","item","emptyObject","package","path","option","unused","invalidFiles","invalidDirs","dependencies","devDependencies","missing","Object","entries","error"],"mappings":"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","sourcesContent":["import BaseCheck from 'depcheck'\nimport BaseTransform from 'node-json-transform'\nimport Is from '@pwn/is'\nimport Merge from 'deepmerge'\n\nimport { Ava } from './special/ava.js'\nimport { Babel } from './special/babel.js'\n\nimport { FileParseError } from './error/file-parse-error.js'\nimport { FolderParseError } from './error/folder-parse-error.js'\n\nconst Process = process\nconst { transform: Transform } = BaseTransform\n\nexport function Check(userPath = Process.cwd(), userOption = {}) {\n\n  return new Promise((resolve, reject) => {\n\n    try {\n\n      let defaultOption = {\n        'parser': {\n          '*.cjs': BaseCheck.parser.es7.default,\n          '*.js': BaseCheck.parser.es7.default\n        },\n        'special': [\n          BaseCheck.special.bin,\n          BaseCheck.special.eslint,\n          Ava,\n          Babel\n        ]\n      }\n  \n      let map = {\n        'item': {\n          'ignoreMatches': 'ignoreMatch',\n          'ignorePatterns': 'ignorePattern',\n          'package': {\n            'dependencies': 'package.dependency',\n            'devDependencies': 'package.devDependency',\n            'peerDependencies': 'package.peerDependency',\n            'optionalDependencies': 'package.optionalDependency'\n          },\n          'parsers': 'parser',\n          'specials': 'special'\n        },\n        'each': (item) => {\n          if (Is.emptyObject(item.package)) {\n            delete item.package\n          }\n          return item\n        }\n      }\n  \n      let path = userPath\n      let option = Transform(Merge(defaultOption, userOption), map)\n\n      BaseCheck(path, option, (unused) => {\n  \n        if (Is.emptyObject(unused.invalidFiles) && \n            Is.emptyObject(unused.invalidDirs)) {\n  \n          resolve({\n            'unused': [ ...unused.dependencies, ...unused.devDependencies ],\n            'missing': unused.missing\n          })\n  \n        } else {\n  \n          if (Is.emptyObject(unused.invalidDirs)) {\n\n            let item = Object.entries(unused.invalidFiles)\n\n            let path = item[0][0]\n            let error = item[0][1]\n\n            reject(new FileParseError(path, error))\n\n          } else {\n\n            let item = Object.entries(unused.invalidDirs)\n\n            let path = item[0][0]\n            let error = item[0][1]\n\n            reject(new FolderParseError(path, error))\n\n          }\n  \n        }\n  \n      })\n\n    } catch(error) {\n      reject(error)\n    }\n\n  })\n\n}"],"file":"check.js"}